"use strict";const eTemplate=function(){this.htmlCode=[],this.htmlType=[],this.htmlSync=[],this.cssRules=[],this.cssCode=[],this.cssType=[],this.syncCnt=0,this.titleCode="",this.fileName="",this.syncClass="et_sync",this.commentDelimiter="<%%",this.openDelimiter="<%",this.closeDelimiter="%>"};eTemplate.prototype.render=async function({openDelimiter:e="<%",closeDelimiter:t="%>",syncUrl:s="",scrollTo:l={},startUrl:r="",syncClass:n="et_sync",iScope:i=""}={}){this.syncCnt=0,this.syncClass=n,this.openDelimiter=e,this.closeDelimiter=t,this.commentDelimiter=e+"%";let o=this.currentUrl().host+this.currentUrl().filename;""==s&&""!=r&&(s=r),""==s&&(s=this.currentUrl().filename),this.fileName=s,o=this.currentUrl().host+s;const c=await fetch(o),a=await c.text();this.getTitle(a),this.changeTitle();const h=await this.readFurther(a,i);return this.removeAllChildNodes(document.querySelector("body")),document.body.insertAdjacentHTML("afterbegin",h.htmlBlock.join("")),l!={}&&0!=Object.keys(l).length&&document.getElementById(l.id).scrollIntoView({block:l.block}),this.htmlCode=h.codeList.code,this.htmlType=h.codeList.type,"function"==typeof addListener&&addListener(s),document.body.style.display="block",new Promise(((e,t)=>{e("done")}))},eTemplate.prototype.readFurther=async function(e,t){"body"!=t&&await this.changeCss(e);let{finalHTML:s,codeList:l}=await this.insertNestedHTML(e);l=this.seperateCode(s,"second");let r=this.makeSyncBlock(l.type,l.code);"JS"==l.type[0]&&(l.type.unshift("HTML"),l.code.unshift(" "),r=r.map((e=>e+1)),r.unshift(0)),l=this.insertSync(l.type,l.code,r),this.htmlSync=r,this.syncCnt=l.syncCnt;let n=this.interpret(l.type,l.code);return new Promise(((e,t)=>{e({htmlBlock:n,codeList:l})}))},eTemplate.prototype.sync=function(e){let t="",s=this.syncClass;this.changeTitle(),document.querySelectorAll(`.${s}`).forEach((e=>{if(t="","INPUT"==e.nodeName){t=e.getAttribute("data-sync"),"number"==e.type?t+="="+(e.value?this.escapeHtml(e.value):'""'):t+="="+(e.value?`"${this.escapeHtml(e.value)}"`:'""');try{temp_code=this.controlCode(t)}catch(e){return e}}}));let l=this.interpretPart(this.htmlType,this.htmlCode,s);document.querySelectorAll(`.${s}`).forEach((e=>{let t=e.classList,r="",n=!1,i=0;t.forEach((e=>{e.includes(`${s}_`)&&(n=!0,r=e.split("_").pop()),e.includes(`${s}Cnt`)&&(i=parseInt(e.replace(`${s}Cnt`,""),10))})),n?e.setAttribute(r,l[i]):(this.removeAllChildNodes(e),e.insertAdjacentHTML("afterbegin",l[i]))})),"body"!=e&&this.syncCss()},eTemplate.prototype.syncCss=function(){if(0==this.cssType.length||!this.cssType.includes("JS"))return!0;let e=this.interpret(this.cssType,this.cssCode),t=this.parseCSS(e.join("")),s=0;for(let e=0;e<document.styleSheets.length;e++)if(null==document.styleSheets[e].href){s=e;break}let l=this.cssRules;const r=/\s+|\\n/g;let n="",i=[],o=[];t.forEach(((e,t)=>{let c=null==e.type?"":e.type,a=-1,h=0,u="";switch(c){case"keyframes":for(let t=0;t<l.length;t++){let s=l[t],r=e.styles.substring(0,e.styles.indexOf("{")).trim(),n=s.styles.substring(0,s.styles.indexOf("{")).trim();if("keyframes"==s.type&&r==n){a=t;break}}if(a>-1){let t=l[a].styles,n=e.styles;t.replace(r,"")!=n.replace(r,"")&&(document.styleSheets[s].deleteRule(a),document.styleSheets[s].insertRule(n,a)),o.push([a,-2,0,7])}else i.push(["rule",t,-1,-1,e.styles]);break;case"media":case"supports":h="media"==c?4:12;for(let t=0;t<l.length;t++){let s=l[t];if(s.type==c&&e.selector==s.selector){a=t;break}}if(a>-1)e.subStyles.forEach(((e,r)=>{u=e.selector;let c=-1;for(let e=0;e<l[a].subStyles.length;e++)if(l[a].subStyles[e].selector==u){c=e;break}if(c>-1)e.rules.forEach(((e,n)=>{let u=-1;for(let t=0;t<l[a].subStyles[c].rules.length;t++){if(l[a].subStyles[c].rules[t].key==e.key){u=t;break}}if(u>-1){let t=l[a].subStyles[c].rules[u].key,r=l[a].subStyles[c].rules[u].value,n=e.value;r!=n&&document.styleSheets[s].cssRules[a].cssRules[c].style.setProperty(t,n),o.push([a,c,u,h])}else i.push(["style",t,r,n,e.key,e.value])}));else{n="    "+e.selector+" {\n";for(let t=0;t<e.rules.length;t++)n+=`        ${e.rules[t].key}: ${e.rules[t].value};\n`;n+="    }\n",i.push(["rule",t,r,-1,n])}}));else{n=e.selector+" {\n";for(let t=0;t<e.subStyles.length;t++){let s=e.subStyles[t];n=n+"    "+s.selector+" {\n";for(let e=0;e<s.rules.length;e++)n+=`        ${s.rules[e].key}: ${s.rules[e].value};\n`;n+="    }\n"}n+="}\n",i.push(["rule",t,-1,-1,n])}break;case"":case"font-face":h="font-face"==c?5:1;for(let t=0;t<l.length;t++){let s=l[t];if(e.selector==s.selector){a=t;break}}if(a>-1)e.rules.forEach(((e,r)=>{let c=-1;for(let t=0;t<l[a].rules.length;t++){if(l[a].rules[t].key==e.key){c=t;break}}if(c>-1){let t=l[a].rules[c].key,r=l[a].rules[c].value,n=e.value;r!=n&&document.styleSheets[s].cssRules[a].style.setProperty(t,n),o.push([a,-1,c,h])}else n=`    ${e.key}: ${e.value};\n`,i.push(["style",t,-1,r,e.key,e.value])}));else{n=e.selector+" {\n";for(let t=0;t<e.rules.length;t++)n+=`    ${e.rules[t].key}: ${e.rules[t].value};\n`;n+="}\n",i.push(["rule",t,-1,-1,n])}}}));let c=0,a=0;for(let e=l.length-1;e>=0;e--){let t=0,r=l[e];switch(r.type){case"media":case"supports":t="media"==r.type?4:12,c=r.subStyles.length;for(let l=c-1;l>=0;l--){a=r.subStyles[l].rules.length;for(let n=a-1;n>=0;n--){if(this.arrayFind(o,[e,l,n,t])<0){let t=r.subStyles[l].rules[n].key;document.styleSheets[s].cssRules[e].cssRules[l].style.removeProperty(t)}}0==document.styleSheets[s].cssRules[e].cssRules[l].style.length&&document.styleSheets[s].cssRules[e].deleteRule(l)}0==document.styleSheets[s].cssRules[e].cssRules.length&&document.styleSheets[s].deleteRule(e);break;case"":case"font-face":t=""==r.type?1:5,a=r.rules.length;for(let l=a-1;l>=0;l--){if(this.arrayFind(o,[e,-1,l,t])<0){let t=r.rules[l].key;document.styleSheets[s].cssRules[e].style.removeProperty(t)}}0==document.styleSheets[s].cssRules[e].style.length&&document.styleSheets[s].deleteRule(e);break;case 7:this.arrayFind(o,[e,-2,0,7])<0&&document.styleSheets[s].deleteRule(e)}}for(let e=0;e<i.length;e++){let[t,l,r,n,o,c=""]=i[e];"style"==t?-1==r?document.styleSheets[s].cssRules[l].style.setProperty(o,c):document.styleSheets[s].cssRules[l].cssRules[r].style.setProperty(o,c):-1==r?document.styleSheets[s].insertRule(o,l):document.styleSheets[s].cssRules[l].insertRule(o,r)}this.cssRules=JSON.parse(JSON.stringify(t))},eTemplate.prototype.findInclude=function(e){let t=[],s=[],l=[],r="",n=0,i="",o=e.indexOf("<body>"),c=e.indexOf("</body>");i=-1==o||-1==c?e:e.substring(o+6,c);let a=this.seperateCode(i,"first");for(let e=0;e<a.type.length;e++)"JS"==a.type[e]&&-1!=a.code[e].search(/include\(.*\)/g)&&(t.push(a.code[e]),l[n]=e,n++);return 0!=t.length&&t.forEach((e=>{e.includes("include(")&&(o=e.indexOf('include("'),-1==o?o=e.indexOf("include('")+9:o+=9,c=e.indexOf('")'),-1==c&&(c=e.indexOf("')")),r=e.substring(o,c),r="/"==r.substring(0,1)?r.substring(1):r,r="./"==r.substring(0,2)?r.substring(2):r,s.push(this.currentUrl().host+r))})),{urls:s,order:l,codeList:a.code}},eTemplate.prototype.insertNestedHTML=async function(e){let t="",{urls:s,order:l,codeList:r}=this.findInclude(e);return 0==s.length?(t=r.join(""),{finalHTML:t,codeList:r}):((await this.getTextFromFiles(s)).forEach(((e,t)=>{r[l[t]]=e})),t=r.join(""),({urls:s,order:l,codeList:r}=this.findInclude(t)),0==s.length||({finalHTML:t,codeList:r}=await this.insertNestedHTML(t)),{finalHTML:t,codeList:r})},eTemplate.prototype.seperateCode=function(e,t){const s=`(${this.openDelimiter}[^%].*?${this.closeDelimiter})`,l=new RegExp(s,"g");let r=e.split(l),n=[];r.forEach(((e,s)=>{let l=e.indexOf(`${this.openDelimiter}`),i=e.indexOf(`${this.closeDelimiter}`),o="";0!=l||i!=e.length-2||e.includes("closeDelimiter:")?(o="HTML",r[s]=this.removeControlText(e).trim()):(o="JS",r[s]="second"==t?e.substring(2,e.length-2).trim():e.trim()),n.push(o)}));let i=n.length;if(i>1)for(let e=i-1;e>=1;e--)n[e]==n[e-1]&&"HTML"==n[e]&&(r[e-1]=r[e-1]+r[e],r.splice(e,1),n.splice(e,1));return{type:n,code:r}},eTemplate.prototype.interpret=function(e,t){let s=[],l=0,r=this.escapeHtml(this.commentDelimiter.replace(this.commentDelimiter,this.openDelimiter)),n=this.escapeHtml(this.closeDelimiter);for(;l<t.length;){switch(e[l]){case"HTML":s.push(t[l].replaceAll(this.commentDelimiter,r).replaceAll(this.closeDelimiter,n));break;case"JS":if("="==t[l].substring(0,1)||"-"==t[l].substring(0,1)){try{s.push(this.basicCode(t[l]))}catch(e){s.push("invalid template")}break}{let r=this.eachBlock(e,t,l);l=r.index;try{s.push(this.controlCode(r.partBlock))}catch(e){s.push("invalid template")}break}}l++}return s},eTemplate.prototype.interpretPart=function(e,t,s){let l=[],r="",n=[],i=[],o=[],c=0,a=0,h=0,u=0,p=this.escapeHtml(this.commentDelimiter.replace(this.commentDelimiter,this.openDelimiter)),d=this.escapeHtml(this.closeDelimiter);for(c=0;c<t.length;c++)if(o.length=0,"HTML"==e[c]&&(a=0,r="",o=this.removeControlText(t[c]).split("<"),o.forEach((e=>{e.includes("class=")&&e.includes(s)&&(r=e.substring(0,e.indexOf(" ")).trim())})),r.length>0))for(h=this.htmlSync[c+1],a=c+1;a<t.length&&this.htmlSync[a]==h;a++)n.push(e[a]),i.push(t[a]);for(;u<i.length;){switch(n[u]){case"HTML":l.push(i[u].replaceAll(this.commentDelimiter,p).replaceAll(this.closeDelimiter,d));break;case"JS":if("="==i[u].substring(0,1)||"-"==i[u].substring(0,1)){try{l.push(this.basicCode(i[u]))}catch(e){l.push("invalid template script")}break}{let e=this.eachBlock(n,i,u);u=e.index;try{l.push(this.controlCode(e.partBlock))}catch(e){l.push("invalid template script")}break}}u++}return l},eTemplate.prototype.makeSyncBlock=function(e,t){let s=[],l=0,r=0,n=0;for(let i=0;i<t.length;i++){switch(e[i]){case"HTML":s.push(l);break;case"JS":if("="==t[i].substring(0,1)||"-"==t[i].substring(0,1)){s.push(l);break}r=this.findBlockEnd(e,t,i).index,n=this.findBlockEnd(e,t,i).braceBalance,n<0?console.log("ERROR: missing {"):n>0&&console.log("ERROR: missing }"),s=[...s,...Array(r-i+1).fill(l)],i=r}l++}return s},eTemplate.prototype.findBlockEnd=function(e,t,s){let l=0,r=0;for(r=s;r<t.length;r++)if(r!=s||"JS"!=e[r]){if("HTML"!=e[r]&&"JS"==e[r]&&"="!=t[r].substring(0,1)&&"-"!=t[r].substring(0,1)&&(t[r].includes("{")&&l++,t[r].includes("}")&&l--,0==l))return{index:r,error:0}}else if(t[r].includes("{")&&l++,t[r].includes("}")&&l--,0==l)return{index:r,error:0};return 0!=l?{index:s,braceBalance:l}:{index:r,braceBalance:l}},eTemplate.prototype.eachBlock=function(e,t,s){let l="",r=0,n=0;for(n=s;n<t.length;n++){if(n==s){if("JS"==e[n]){if(t[n].includes("{")&&r++,t[n].includes("}")&&r--,0==r)return{partBlock:t[n],index:n};l=`let answer=''; ${t[n]}`;continue}l=`let answer='${t[n]}';`}if("HTML"!=e[n]){if("JS"==e[n])if("="==t[n].substring(0,1)||"-"==t[n].substring(0,1))l+=`answer += ${t[n].substring(1)};`;else if(l+=t[n],t[n].includes("{")&&r++,t[n].includes("}")&&r--,0==r)return l+="; return answer;",{partBlock:l,index:n}}else l+=`answer += '${t[n]}';`}return l+="; return answer;",{partBlock:l,index:n}},eTemplate.prototype.insertSync=function(e,t,s){let l=-1,r=0,n=0,i="",o="",c="",a="",h=0,u=0,p=0,d=this.syncCnt;const m=this.syncClass;for(let y=0;y<s.length;y++)if(s[y]!=l&&"JS"==e[y])if(l=s[y],u=0,p=0,h=y,u=s.lastIndexOf(s[h]),c=t[y-1],">"!=c.substring(c.length-1))if(n=c.lastIndexOf(">"),r=c.lastIndexOf("<"),n<r){i=c.substring(r);let e=c.lastIndexOf(" "),s=c.lastIndexOf('="'),l=c.substring(e+1,s);i.includes("class=")?(p=c.indexOf("class=",r)+7,t[y-1]=`${c.substring(0,p)}${m} ${m}_${l} ${m}Cnt${d} ${c.substring(p)}`,d++):(a=t[y+1],n=a.indexOf(">"),i=a.substring(0,n),i.includes("class=")?(p=a.indexOf("class=")+7,t[y+1]=`${a.substring(0,p)}${m} ${m}_${l} ${m}Cnt${d} ${a.substring(p)}`,d++):(r=c.lastIndexOf("<"),n=c.indexOf(" ",r),t[y-1]=`${c.substring(0,n+1)} class="${m} ${m}_${l} ${m}Cnt${d}" ${c.substring(n+1)}`,d++))}else t[y-1]=t[y-1]+`<span class="${m} ${m}Cnt${d}">`,d++,t[u+1]="</span>"+t[u+1];else r=c.lastIndexOf("<"),o=c.substring(r+1,c.length).split(" ")[0],"</"!=c.substring(r,r+2)?t[u+1].includes("</"+o)&&t[u+1].indexOf("</"+o)<(-1==t[u+1].indexOf("<"+o)?t[u+1].length:t[u+1].indexOf("<"+o))?(n=c.length-1,r=c.lastIndexOf("<"),i=c.substring(r,n+1),i.includes("class=")?(p=c.indexOf("class=",r)+7,t[y-1]=`${c.substring(0,p)}${m} ${m}Cnt${d} ${c.substring(p)}`,d++):(t[y-1]=`${c.substring(0,c.length-1)} class="${m} ${m}Cnt${d}" ${c.substring(c.length-1,c.length)}`,d++)):(t[y-1]=`${t[y-1]}<span class="${m} ${m}Cnt${d}">`,d++,t[y+1]=`</span>${t[y+1]}`):(t[y-1]=`${t[y-1]}<span class="${m} ${m}Cnt${d}">`,d++,t[u+1]=`</span>${t[u+1]}`);else l=s[y];return{type:e,code:t,syncCnt:d}},eTemplate.prototype.getTitle=function(e){const t=e.match(/<head>(.|[\t\n\r])*?<\/head>/g)[0].match(/<title>(.|[\t\n\r])*?<\/title>/g)[0].replace("<title>","").replace("</title>","").trim();this.titleCode=t.length>0?t:this.titleCode},eTemplate.prototype.changeTitle=function(){const e=`${this.openDelimiter}[^%].*?${this.closeDelimiter}`,t=new RegExp(e,"g");let s=null;null!=this.titleCode.trim().match(t)&&(s=this.titleCode.trim().match(t)[0].replaceAll(`${this.openDelimiter}`,"").replaceAll(`${this.closeDelimiter}`,""));let l="";null!=s&&(l=this.basicCode(s),document.head.querySelector("title").innerText=l)},eTemplate.prototype.changeCss=async function(e){let t=await this.combineCss(e),s=this.seperateCode(t,"second");this.cssCode=s.code,this.cssType=s.type,t=this.interpret(s.type,s.code).join("");let l=this.parseCSS(t);this.cssRules=l;const r=this.createTextStyle(l);if(""==r)return;document.querySelectorAll("style").forEach((e=>{e.parentNode.removeChild(e)}));let n=document.createElement("style");n.appendChild(document.createTextNode(r)),document.head.appendChild(n),document.head.querySelectorAll("link").forEach((e=>{"stylesheet"!=e.getAttribute("rel")||e.getAttribute("href").includes("http")||e.parentNode.removeChild(e)}))},eTemplate.prototype.combineCss=async function(e){let t=[],s=[],l=e.indexOf("<head>"),r=e.indexOf("</head>");if(-1==l||-1==r)return"";e.replace(/<style>(.|[\t\n\r])*?<.style>/gi,(function(e){return s.push(e.replaceAll("<style>","").replaceAll("</style>","")),""}));let n=s.join(""),i=[];e.replace(/<link.*?(rel=("|')stylesheet("|')).*?>/gi,(function(e){return i.push(e),""}));let o=this.currentUrl().host;return i.forEach((e=>{let s=e.match(/href=".*?"/gi)[0].replaceAll("href=","").replaceAll('"',"");s.includes("http")||t.push(o+s)})),n=(await this.getTextFromFiles(t)).reduce(((e,t)=>e+t),n),n=await this.insertNestedCSS(n),n},eTemplate.prototype.insertNestedCSS=async function(e){let t="",{urls:s,order:l,codeList:r}=this.findImport(e);return 0==s.length?(t=r.join(""),t):((await this.getTextFromFiles(s)).forEach(((e,t)=>{r[l[t]]=e})),t=r.join(""),({urls:s,order:l,codeList:r}=this.findImport(t)),0!=s.length?(t=await this.insertNestedCSS(t),t):t)},eTemplate.prototype.findImport=function(e){let t=[],s=[],l=[],r="",n=0;const i=/@import *["|'].*?["|'];/g;let o=this.seperateImport(e);for(let e=0;e<o.type.length;e++)"IMPORT"==o.type[e]&&-1!=o.code[e].search(i)&&(t.push(o.code[e]),l[n]=e,n++);return 0!=t.length&&t.forEach((e=>{r=e.match(i)[0].replaceAll("@import","").replaceAll('"',"").replaceAll(";","\n").trim(),r="/"==r.substring(0,1)?r.substring(1):r,r="./"==r.substring(0,2)?r.substring(2):r,s.push(this.currentUrl().host+r)})),{urls:s,order:l,codeList:o.code}},eTemplate.prototype.seperateImport=function(e){let t=e.split(/(@import *["|'].*?["|'];)/g),s=[];return t.forEach(((e,l)=>{let r=e.includes("@import")?"IMPORT":"OTHER";s.push(r),t[l]=e.includes("@import")?e.trim():this.removeControlText(e).trim()})),{type:s,code:t}},eTemplate.prototype.createTextStyle=function(e){let t="";return JSON.parse(JSON.stringify(e)).forEach((e=>{switch(null==e.type?"":e.type){case"":case"font-face":t=t+e.selector+" {\n",e.rules.forEach((e=>{t+=`    ${e.key}: ${e.value};\n`})),t+="}\n";break;case"imports":case"keyframes":t=t+e.styles.replaceAll("{","{\n").replaceAll("}","}\n").replaceAll(";",";\n")+"\n";break;case"supports":case"media":t=t+e.selector+" {\n",e.subStyles.forEach((e=>{t=t+"    "+e.selector+" {\n",e.rules.forEach((e=>{t+=`        ${e.key}: ${e.value};\n`})),t+="    }\n"})),t+="}\n"}})),t},eTemplate.prototype.basicCode=function(e){try{return Function(`"use strict"; return ( ${e.substring(1)} )`)()}catch(e){return`${e.message}`}},eTemplate.prototype.controlCode=function(e){try{return Function(`"use strict"; ${e.replace(/[\n\r\t]/g,"")}`)()}catch(e){return"invalid template block"}},eTemplate.prototype.renderPart=async function(e="",t=""){let s="",l="",r="",n=[],i=[],o="",c="",a=[],h=[],u="";if(""==t.trim())return"select type from html, html_path";if(""==e.trim())return"nothing to render";switch(t){case"html":return s=e,n=this.seperateCode(s,"second"),i=this.makeSyncBlock(n.type,n.code),"JS"==n.type[0]&&(n.type.unshift("HTML"),n.code.unshift(" "),i=i.map((e=>e+1)),i.unshift(0)),n=this.insertSync(n.type,n.code,i),l=this.interpret(n.type,n.code),o=l.join(""),{domText:o,sourceType:n.type,sourceCode:n.code,sourceSync:i};case"html_path":r=this.currentUrl().host+e;try{const e=await fetch(r);s=await e.text()}catch(e){return"incorrect pathname"}return n=this.seperateCode(s,"second"),i=this.makeSyncBlock(n.type,n.code),"JS"==n.type[0]&&(n.type.unshift("HTML"),n.code.unshift(" "),i=i.map((e=>e+1)),i.unshift(0)),n=this.insertSync(n.type,n.code,i),l=this.interpret(n.type,n.code),o=l.join(""),{domText:o,sourceType:n.type,sourceCode:n.code,sourceSync:i};case"css":return s=e,s=await this.insertNestedCSS(s),n=this.seperateCode(s,"second"),a=this.interpret(n.type,n.code),c=a.join(""),h=this.parseCSS(c),u=this.createTextStyle(h),u;case"css_path":r=this.currentUrl().host+e;try{const e=await fetch(r);s=await e.text()}catch(e){return"incorrect pathname"}return s=await this.insertNestedCSS(s),n=this.seperateCode(s,"second"),a=this.interpret(n.type,n.code),c=a.join(""),h=this.parseCSS(c),u=this.createTextStyle(h),u}},eTemplate.prototype.appendHtml=function(e={},t){let s=e.domText||"";if(null==t)return"no element to append to";const l=e.sourceType||[],r=e.sourceCode||[],n=e.sourceSync||[];return"DOMobject"!=this.getObjectType(t)?"invalid object to append to":0==l.length?"nothing to append":(this.htmlType=[...this.htmlType,...l],this.htmlCode=[...this.htmlCode,...r],this.htmlSync=[...this.htmlSync,...n],s=s.trim(),""==s?"nothing to append":void t.insertAdjacentHTML("beforeend",s))},eTemplate.prototype.appendCss=function(e){let t;if(null==document.querySelector("style"))return t=document.createElement("style"),t.appendChild(document.createTextNode(e)),void document.head.appendChild(t);t=document.createTextNode(e),document.querySelector("style").appendChild(t)},eTemplate.prototype.currentUrl=function(){let e=window.location.href,t=window.location.hash;e=e.replace(t,"");let s=e.split("/").pop(),l=e.substring(0,e.length-s.length);return""!=t&&(s=t.substring(1)+".html"),{host:l,filename:s}},eTemplate.prototype.getTextFromFiles=async e=>{if(0==e.length)return[];let t=e.map((e=>fetch(e))),s=await Promise.all(t),l=s.filter((e=>!e.ok));if(l.length>0)throw l.map((e=>Error(e.statusText)));let r=s.map((e=>e.text()));return await Promise.all(r)},eTemplate.prototype.getObjectType=e=>("object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName)?"DOMobject":e.includes("<%")&&e.includes("%>")?"template":e.includes(".html")?"html_path":e.includes(".css")?"css_path":"undefined",eTemplate.prototype.hashtofilename=function(e){let t=window.location.hash;return""!=t&&""==e&&(e=t.substring(1)+".html"),e},eTemplate.prototype.removeAllChildNodes=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},eTemplate.prototype.parseCSS=function(e){if(void 0===e)return[];let t=/@import .*?\(.*?\);/gi,s=/((@keyframes [\s\S]*?){([\s\S]*?}\s*?)})/gi,l=[];return[...(e=e.replace(/\/\*.*?\*\//gi,"")).matchAll(t)].forEach((e=>{l.push({selector:"@imports",type:"imports",styles:e[0]})})),[...(e=e.replace(t,"")).matchAll(s)].forEach((e=>{l.push({selector:"@keyframes",type:"keyframes",styles:e[0]})})),[...(e=e.replace(s,"")).matchAll(/((\s*?(?:\/\*[\s\S]*?\*\/)?\s*?(@media|@supports)[\s\S]*?){([\s\S]*?)}\s*?})|(([\s\S]*?){([\s\S]*?)})/gi)].forEach((e=>{let t=void 0===e[2]?e[6]:e[2];t=t.split("\r\n").join("\n").trim().replace(/\n+/,"\n");let s=t.includes("@media")?"media":t.includes("@supports")?"supports":"@font-face"===t?"font-face":"",r={selector:t,type:s};"media"===s||"supports"===s?r.subStyles=this.parseCSS(e[4]+"\n}"):r.rules=this.parseRules(e[7]),l.push(r)})),l},eTemplate.prototype.parseRules=function(e){let t=[];return(e=(e=e.split("\r\n").join("\n")).split(";")).forEach((e=>{if((e=e.trim()).includes(":")){let s=(e=e.split(":"))[0].trim(),l=e.slice(1).join(":").trim();s.length>0&&l.length>0&&t.push({key:s,value:l})}else"base64,"===e.trim().substr(0,7)?t[t.length-1].value+=e.trim():e.length>0&&t.push({key:"",value:e,defective:!0})})),t},eTemplate.prototype.arrayFind=function(e,t){let s={};return e.map(((e,t)=>s[e]=t)),s.hasOwnProperty(t)?s[t]:-1},eTemplate.prototype.escapeHtml=function(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","(":"&#40;",")":"&#41;"};return e.replace(/[&<>"'()]/g,(function(e){return t[e]}))},eTemplate.prototype.removeControlText=function(e){return e.replaceAll(/\r|\n|\t/g,"")},document.onmouseover=function(){window.innerDocClick=!0},document.onmouseleave=function(){window.innerDocClick=!1};